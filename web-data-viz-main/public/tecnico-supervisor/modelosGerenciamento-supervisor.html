<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../base/navbar.css">
</head>
<body>
   <nav class="barra-lateral">

    <a class="item-logo">
      <img src="../assets/icon/menu-aberto.png" alt="Logo Cortex" class="logotipo">
      <span class="texto-logo">Cortex</span>
    </a>

    <a class="item-navegacao" href="./dash_tecnico-supervisor.html">
      <img src="../assets/icon/graficos.png" id="dash-zona" alt="">
      <span class="texto" id="texto-dash">Dashboard Alerta</span>
    </a>

    <div class="divisor"></div>

    <a class="item-navegacao" href="./gerenciamento_de_cliente-supervisor.html">
      <img src="../assets/icon/icons8-curso-atribuir-80.png" id="atribuicao" alt="">
      <span class="texto">Clientes</span>
    </a>

    <a class="item-navegacao" href="./gerenciamento_de_funcionario-supervisor.html">
      <img src="../assets/icon/gestor-de-projeto.png" id="gerenciamento" alt="">
      <span class="texto">Funcion√°rios</span>
    </a>

    <a class="item-navegacao" href="./modelosGerenciamento-supervisor.html">
      <img src="../assets/icon/modelo.png" id="modelo" alt="">
       <span class="texto">Modelos</span>
    </a>

        <a class="item-notificacao" href="./zona-supervisor.html">
      <img src="../assets/icon/sino.png" id="sino" alt="">
      <span class="texto-notificacao" id="notificacoes">Zonas</span>
    </a>

    <div class="divisor"></div>



    <a class="item-usuario" href="./perfil-supervisor.html">
      <img src="../assets/icon/teste-perfil.webp" alt="Avatar Jos√©" class="avatar-usuario">
      <span class="texto-usuario">Jos√©</span>
    </a>

    <div class="divisor"></div>

    <a class="item-notificacao">
      <img src="../assets/icon/sair (1).png" id="sair-imagem" alt="">
      <span class="texto-notificacao" id="sair">Sair</span>
    </a>
  </nav>
  <section id="models" class="tab-content">
    <div class="crud-section">
      <div class="crud-header">
        <h2 class="crud-title">Gest√£o de Modelos de IA</h2>
        <div class="crud-actions">
          <input type="text" class="search-bar" placeholder="üîç Buscar modelo..." id="searchModels" />
          <button class="btn btn-primary" onclick="openModal()">‚ûï Adicionar Modelo</button>
        </div>
      </div>
      <table>
        <thead>
          <tr><th>Modelo</th><th>Vers√£o</th><th>Servidor Vinculado</th><th>Prioridade</th><th>Requests/M√™s</th><th>Status</th><th>A√ß√µes</th></tr>
        </thead>
        <tbody id="modelsTable"></tbody>
      </table>
    </div>
  </section>

  <!-- Modal CRUD -->
  <div class="modal-overlay" id="crudModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Adicionar Modelo</div>
        <button class="close-btn" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-content">
        <form id="modalForm" onsubmit="return saveForm(event)">
          <div class="form-grid" id="formGrid"></div>
          <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:6px;">
            <button type="button" class="btn" onclick="closeModal()">Cancelar</button>
            <button type="submit" class="btn btn-primary">Salvar</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    let models = [
      {model:'GPT-4-Turbo', version:'v4.1', server:'SRV-TC-001', priority:'Alta', requests:'1.2M/m√™s', status:'Ativo'},
      {model:'Claude 3', version:'v3.5', server:'SRV-TC-002', priority:'Alta', requests:'950K/m√™s', status:'Ativo'},
      {model:'DALL-E 3', version:'v3.0', server:'SRV-DV-001', priority:'M√©dia', requests:'800K/m√™s', status:'Ativo'},
      {model:'Gemini Pro', version:'v1.5', server:'SRV-NS-001', priority:'M√©dia', requests:'900K/m√™s', status:'Ativo'},
      {model:'Whisper', version:'v2.5', server:'SRV-NS-002', priority:'Baixa', requests:'650K/m√™s', status:'Ativo'}
    ];

    const FORM_MODEL = [
      {name:'model', label:'Modelo', type:'text'},
      {name:'version', label:'Vers√£o', type:'text'},
      {name:'server', label:'Servidor Vinculado', type:'text'},
      {name:'priority', label:'Prioridade', type:'select', options:['Alta','M√©dia','Baixa']},
      {name:'requests', label:'Requests/M√™s', type:'text'},
      {name:'status', label:'Status', type:'select', options:['Ativo','Aten√ß√£o']}
    ];

    let editIndex = null;

    function renderModels(list = models) {
      const tbody = document.getElementById('modelsTable');
      tbody.innerHTML = list.map((m, i) => `
        <tr>
          <td>${m.model}</td>
          <td>${m.version}</td>
          <td>${m.server}</td>
          <td>${m.priority}</td>
          <td>${m.requests}</td>
          <td>${m.status}</td>
          <td>
            <button onclick="editModel(${i})">‚úèÔ∏è</button>
            <button onclick="deleteModel(${i})">üóëÔ∏è</button>
          </td>
        </tr>`).join('');
    }

    document.getElementById('searchModels').addEventListener('input', e => {
      const q = e.target.value.toLowerCase();
      renderModels(models.filter(m => Object.values(m).join(' ').toLowerCase().includes(q)));
    });

    function openModal(index = null) {
      editIndex = index;
      document.getElementById('modalTitle').textContent = index === null ? 'Adicionar Modelo' : 'Editar Modelo';

      const grid = document.getElementById('formGrid');
      const values = index !== null ? models[index] : {};

      grid.innerHTML = FORM_MODEL.map(f => {
        const val = values[f.name] || '';
        if (f.type === 'select') {
          return `
            <label>
              ${f.label}
              <select name="${f.name}">
                ${f.options.map(o => `<option ${o === val ? 'selected' : ''}>${o}</option>`).join('')}
              </select>
            </label>`;
        }
        return `
          <label>
            ${f.label}
            <input type="${f.type}" name="${f.name}" value="${val}">
          </label>`;
      }).join('');

      document.getElementById('crudModal').classList.add('active');
    }

    function closeModal() {
      document.getElementById('crudModal').classList.remove('active');
    }

    function saveForm(e) {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());

      if (editIndex === null) {
        models.push(data);
      } else {
        models[editIndex] = data;
      }

      renderModels();
      closeModal();
    }

    function editModel(index) {
      openModal(index);
    }

    function deleteModel(index) {
      if (confirm('Tem certeza que deseja excluir?')) {
        models.splice(index, 1);
        renderModels();
      }
    }

    renderModels();
  </script>
</body>
</html>
