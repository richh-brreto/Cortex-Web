<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes - Cortex</title>

    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/gerenciamento_cliente.css">

    <link rel="stylesheet" href="componentes/input-components/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="componentes/navbar/NavBarComponent.js" type="module"></script>
    <script src="componentes/input-components/cortex-pesquisar.js" type="module"></script>
</head>
<body>

    <custom-navbar role="admin" user-name="André"></custom-navbar>

    <main class="conteudo-principal">
        <div class="container-clientes">
            <header class="header-clientes">
                <h1>Clientes</h1>
            </header>

            <section class="barra-acoes">
                <search-cortex placeholder="Pesquisar..."></search-cortex>
                
                <div class="acoes-container">
                    <button id="btn-adicionar" class="btn btn-primario">Adicionar <b>+</b></button>
                    <div class="ordenar-filtros">
                        <label>Ordenar por:</label>
                        <div class="filtros-opcoes">
                            <label>
                                <input type="checkbox" name="ordenar" value="entrada"> Entrada
                            </label>
                            <label>
                                <input type="checkbox" name="ordenar" value="qtd-modelos"> Qtd. modelos
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="container-tabela">
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Descrição</th>
                            <th>CNPJ</th>
                            <th>Telefone</th>
                            <th>Quantidade de modelos</th>
                            <th>Quantidade de zonas de distribuição dos modelos</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-clientes-corpo">
                        <tr>
                            <td>Cliente Exemplo 1</td>
                            <td>Descrição do cliente exemplo com mais detalhes</td>
                            <td>12.345.678/0001-90</td>
                            <td>(11) 3456-7890</td>
                            <td>5</td>
                            <td>12</td>
                            <td>
                                <div class="coluna-acoes">
                                    <button class="btn btn-secundario">Ver mais</button>
                                    <button class="btn-icone" title="Editar">
                                        <span class="material-icons">edit</span>
                                    </button>
                                    <button class="btn-icone" title="Excluir">
                                        <span class="material-icons">delete</span>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Cliente Exemplo 2</td>
                            <td>Outra descrição de cliente</td>
                            <td>98.765.432/0001-10</td>
                            <td>(11) 9876-5432</td>
                            <td>8</td>
                            <td>20</td>
                            <td>
                                <div class="coluna-acoes">
                                    <button class="btn btn-secundario">Ver mais</button>
                                    <button class="btn-icone" title="Editar">
                                        <span class="material-icons">edit</span>
                                    </button>
                                    <button class="btn-icone" title="Excluir">
                                        <span class="material-icons">delete</span>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>Cliente Exemplo 3</td>
                            <td>Terceira descrição exemplo</td>
                            <td>11.222.333/0001-44</td>
                            <td>(21) 2222-3333</td>
                            <td>3</td>
                            <td>7</td>
                            <td>
                                <div class="coluna-acoes">
                                    <button class="btn btn-secundario">Ver mais</button>
                                    <button class="btn-icone" title="Editar">
                                        <span class="material-icons">edit</span>
                                    </button>
                                    <button class="btn-icone" title="Excluir">
                                        <span class="material-icons">delete</span>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </div>
    </main>

    <div id="modal-cliente" class="modal-overlay oculto">
        <div class="modal-conteudo">
            <header class="modal-header">
                <h2 id="modal-titulo">Adicionar Cliente</h2>
                <button id="btn-fechar-modal" class="btn-icone">&times;</button>
            </header>
            <form id="form-cliente" class="modal-form">
                <div class="campo-form">
                    <label for="nome">Nome</label>
                    <input type="text" id="nome" placeholder="Digite o nome do cliente..." required>
                </div>
                <div class="campo-form">
                    <label for="descricao">Descrição</label>
                    <textarea id="descricao" rows="3" placeholder="Descrição do cliente..."></textarea>
                </div>
                <div class="campo-form">
                    <label for="cnpj">CNPJ</label>
                    <input type="text" id="cnpj" placeholder="Digite o CNPJ do cliente..." required>
                </div>
                <div class="campo-form">
                    <label for="telefone">Telefone</label>
                    <input type="tel" id="telefone" placeholder="Digite o telefonedo cliente...">
                </div>
                <div class="campo-form">
                    <label for="qtd-modelos">Quantidade de Modelos</label>
                    <input type="number" id="qtd-modelos" min="0" placeholder="Digite a quantidade de modelos do cliente...">
                </div>
                <div class="campo-form">
                    <label for="qtd-zonas">Quantidade de Zonas de Distribuição</label>
                    <input type="number" id="qtd-zonas" min="0"  placeholder="Digite quantidade de zonas de distribuição do cliente...">
                </div>

                <div class="modal-actions">
                    <button type="button" id="btn-cancelar" class="btn btn-secundario">Cancelar</button>
                    <button type="submit" class="btn btn-primario">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        const modal = document.getElementById('modal-cliente');
        const btnAdicionar = document.getElementById('btn-adicionar');
        const btnFechar = document.getElementById('btn-fechar-modal');
        const btnCancelar = document.getElementById('btn-cancelar');
        const form = document.getElementById('form-cliente');

        btnAdicionar.addEventListener('click', () => {
            modal.classList.remove('oculto');
            document.getElementById('modal-titulo').textContent = 'Adicionar Cliente';
        });

        btnFechar.addEventListener('click', () => {
            modal.classList.add('oculto');
        });

        btnCancelar.addEventListener('click', () => {
            modal.classList.add('oculto');
            form.reset();
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('oculto');
            }
        });

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const novoCliente = {
                nome: document.getElementById('nome').value,
                descricao: document.getElementById('descricao').value,
                cnpj: document.getElementById('cnpj').value,
                telefone: document.getElementById('telefone').value,
                qtdModelos: document.getElementById('qtd-modelos').value,
                qtdZonas: document.getElementById('qtd-zonas').value
            };

            console.log('Novo cliente:', novoCliente);
            
            const tbody = document.getElementById('tabela-clientes-corpo');
            const novaLinha = tbody.insertRow();
            novaLinha.innerHTML = `
                <td>${novoCliente.nome}</td>
                <td>${novoCliente.descricao}</td>
                <td>${novoCliente.cnpj}</td>
                <td>${novoCliente.telefone}</td>
                <td>${novoCliente.qtdModelos}</td>
                <td>${novoCliente.qtdZonas}</td>
                <td>
                    <div class="coluna-acoes">
                        <button class="btn btn-secundario">Ver mais</button>
                        <button class="btn-icone" title="Editar">
                            <span class="material-icons">edit</span>
                        </button>
                        <button class="btn-icone" title="Excluir">
                            <span class="material-icons">delete</span>
                        </button>
                    </div>
                </td>
            `;

            modal.classList.add('oculto');
            form.reset();
        });

        const cortexPesquisar = document.querySelector('cortex-pesquisar');
        if (cortexPesquisar) {
            cortexPesquisar.addEventListener('input', (e) => {
                const termo = e.detail?.value?.toLowerCase() || e.target.value?.toLowerCase() || '';
                const linhas = document.querySelectorAll('#tabela-clientes-corpo tr');
                
                linhas.forEach(linha => {
                    const texto = linha.textContent.toLowerCase();
                    linha.style.display = texto.includes(termo) ? '' : 'none';
                });
            });
        }

        const checkboxes = document.querySelectorAll('input[name="ordenar"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                console.log('Filtro alterado:', checkbox.value, checkbox.checked);
                // Implementar lógica de ordenação aqui
            });
        });

        document.addEventListener('click', (e) => {
            const btnEdit = e.target.closest('.btn-icone[title="Editar"]');
            const btnDelete = e.target.closest('.btn-icone[title="Excluir"]');

            if (btnEdit) {
                const linha = btnEdit.closest('tr');
                const nome = linha.cells[0].textContent;
                console.log('Editando cliente:', nome);
                modal.classList.remove('oculto');
                document.getElementById('modal-titulo').textContent = 'Editar Cliente';
            }

            if (btnDelete) {
                const linha = btnDelete.closest('tr');
                const nome = linha.cells[0].textContent;
                if (confirm(`Deseja realmente excluir o cliente "${nome}"?`)) {
                    linha.remove();
                    console.log('Cliente excluído:', nome);
                }
            }
        });
    </script>

</body>
</html>