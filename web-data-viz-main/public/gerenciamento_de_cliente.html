<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciamento de Usuários - Cortex</title>
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/gerenciamento.css">
    <link rel="stylesheet" href="componentes/input-components/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <script src="componentes/navbar/NavBarComponent.js" type="module"></script>
    <script src="componentes/input-components/cortex-pesquisar.js" type="module"></script>
</head>
<body>

    <custom-navbar role="user" user-name="André"></custom-navbar>

    <main class="conteudo-principal">
        <div class="container-gerenciamento">
            <header class="header-gerenciamento">
                <h1>Gerenciamento de Usuários</h1>
            </header>

        <section class="barra-acoes">
            <search-cortex placeholder="Pesquisar..."></search-cortex>
            
            <div class="filtros-container">
                <button id="btn-criar-usuario" class="btn btn-primario">
                    Criar +
                </button>
                <fieldset class="filtros-tipo">
                    <legend>Tipo</legend>
                    <label>
                        <input type="checkbox" name="tipo" value="todos" checked> Todos
                    </label>
                    <label>
                        <input type="checkbox" name="tipo" value="tecnico"> Técnico
                    </label>
                    <label>
                        <input type="checkbox" name="tipo" value="analista"> Analista
                    </label>
                </fieldset>
            </div>
        </section>

        <section class="container-tabela">
            <table>
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Nome</th>
                        <th>CPF</th>
                        <th>Telefone</th>
                        <th>Cargo</th>
                        <th>Email</th>
                        <th>Senha</th>
                        <th>Tipo de usuário</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody id="tabela-usuarios-corpo">
                    <tr>
                        <td>
                            <div class="avatar-tabela">
                                <span class="material-icons">account_circle</span>
                            </div>
                        </td>
                        <td>Nome Genérico Souza</td>
                        <td>123.456.789-09</td>
                        <td>(11) 98583-1860</td>
                        <td>Cargo 1</td>
                        <td>nome.souza@gmail.com</td>
                        <td>
                            <span class="senha-mascarada">
                                ••••••••••
                                <button class="btn-icone" title="Mostrar senha">
                                    <span class="material-icons">visibility</span>
                                </button>
                            </span>
                        </td>
                        <td>Executivo</td>
                        <td>
                            <div class="coluna-acoes">
                                <button class="btn btn-secundario">Ver zonas</button>
                                <button class="btn-icone" title="Editar">
                                    <span class="material-icons">edit</span>
                                </button>
                                <button class="btn-icone" title="Excluir">
                                    <span class="material-icons">delete</span>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="avatar-tabela">
                                <span class="material-icons">account_circle</span>
                            </div>
                        </td>
                        <td>Nome Genérico Santos</td>
                        <td>123.697.231-09</td>
                        <td>(11) 98437-1740</td>
                        <td>Cargo 2</td>
                        <td>nome.santos@gmail.com</td>
                        <td>
                            <span class="senha-mascarada">
                                ••••••••••
                                <button class="btn-icone" title="Mostrar senha">
                                    <span class="material-icons">visibility</span>
                                </button>
                            </span>
                        </td>
                        <td>Técnico</td>
                        <td>
                            <div class="coluna-acoes">
                                <button class="btn btn-secundario">Ver zonas</button>
                                <button class="btn-icone" title="Editar">
                                    <span class="material-icons">edit</span>
                                </button>
                                <button class="btn-icone" title="Excluir">
                                    <span class="material-icons">delete</span>
                                </button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        </div>
    </main>

    <div id="modal-usuario" class="modal-overlay oculto">
        <div class="modal-conteudo">
            <header class="modal-header">
                <h2 id="modal-titulo">Criar Novo Usuário</h2>
                <button id="btn-fechar-modal" class="btn-icone">&times;</button>
            </header>
            <form id="form-usuario" class="modal-form">
                <div class="campo-form">
                    <label for="nome">Nome e Sobrenome</label>
                    <input type="text" id="nome" required>
                </div>
                <div class="campo-form">
                    <label for="email">Email</label>
                    <input type="email" id="email" required>
                </div>
                <div class="campo-form">
                    <label for="cpf">CPF</label>
                    <input type="text" id="cpf" required>
                </div>
                <div class="campo-form">
                    <label for="telefone">Telefone</label>
                    <input type="tel" id="telefone">
                </div>
                <div class="campo-form">
                    <label for="cargo">Cargo</label>
                    <input type="text" id="cargo">
                </div>
                <div class="campo-form">
                    <label for="senha">Senha</label>
                    <input type="password" id="senha" required>
                </div>
                <div class="campo-form">
                    <label for="tipo-usuario">Tipo de Usuário</label>
                    <select id="tipo-usuario">
                        <option value="Executivo">Executivo</option>
                        <option value="Tecnico">Técnico</option>
                        <option value="Analista">Analista</option>
                    </select>
                </div>

                <div class="modal-actions">
                    <button type="button" id="btn-cancelar" class="btn btn-secundario">Cancelar</button>
                    <button type="submit" class="btn btn-primario">Salvar</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Modal
        const modal = document.getElementById('modal-usuario');
        const btnCriar = document.getElementById('btn-criar-usuario');
        const btnFechar = document.getElementById('btn-fechar-modal');
        const btnCancelar = document.getElementById('btn-cancelar');
        const form = document.getElementById('form-usuario');

        btnCriar.addEventListener('click', () => {
            modal.classList.remove('oculto');
        });

        btnFechar.addEventListener('click', () => {
            modal.classList.add('oculto');
        });

        btnCancelar.addEventListener('click', () => {
            modal.classList.add('oculto');
            form.reset();
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('oculto');
            }
        });

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const novoUsuario = {
                nome: document.getElementById('nome').value,
                email: document.getElementById('email').value,
                cpf: document.getElementById('cpf').value,
                telefone: document.getElementById('telefone').value,
                cargo: document.getElementById('cargo').value,
                senha: document.getElementById('senha').value,
                tipo: document.getElementById('tipo-usuario').value
            };

            console.log('Novo usuário:', novoUsuario);
            
            // Adicionar nova linha na tabela
            const tbody = document.getElementById('tabela-usuarios-corpo');
            const novaLinha = tbody.insertRow();
            novaLinha.innerHTML = `
                <td>
                    <div class="avatar-tabela">
                        <span class="material-icons">account_circle</span>
                    </div>
                </td>
                <td>${novoUsuario.nome}</td>
                <td>${novoUsuario.cpf}</td>
                <td>${novoUsuario.telefone}</td>
                <td>${novoUsuario.cargo}</td>
                <td>${novoUsuario.email}</td>
                <td>
                    <span class="senha-mascarada">
                        ••••••••••
                        <button class="btn-icone" title="Mostrar senha">
                            <span class="material-icons">visibility</span>
                        </button>
                    </span>
                </td>
                <td>${novoUsuario.tipo}</td>
                <td>
                    <div class="coluna-acoes">
                        <button class="btn btn-secundario">Ver zonas</button>
                        <button class="btn-icone" title="Editar">
                            <span class="material-icons">edit</span>
                        </button>
                        <button class="btn-icone" title="Excluir">
                            <span class="material-icons">delete</span>
                        </button>
                    </div>
                </td>
            `;

            modal.classList.add('oculto');
            form.reset();
        });

        // Pesquisa usando o componente cortex-pesquisar
        const cortexPesquisar = document.querySelector('cortex-pesquisar');
        if (cortexPesquisar) {
            cortexPesquisar.addEventListener('input', (e) => {
                const termo = e.detail?.value?.toLowerCase() || e.target.value?.toLowerCase() || '';
                const linhas = document.querySelectorAll('#tabela-usuarios-corpo tr');
                
                linhas.forEach(linha => {
                    const texto = linha.textContent.toLowerCase();
                    linha.style.display = texto.includes(termo) ? '' : 'none';
                });
            });
        }

        // Filtros de tipo
        const checkboxes = document.querySelectorAll('input[name="tipo"]');
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                // Implementar lógica de filtro aqui
                console.log('Filtro alterado:', checkbox.value, checkbox.checked);
            });
        });
    </script>

</body>
</html>